{% extends 'staff_pages/staff_base.html' %}

{% block content %}
    <section id="bc" class="mt-3">
    <div class="container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
              <a href="{% url 'index' %}">
            <i class="fa fa-home"></i> Home </a>
          </li>
            <li class="breadcrumb-item active">{{ bc_param }}</li>
        </ol>
      </nav>
    </div>
  </section>
     <div style="margin-top: 15px; flex-wrap: nowrap" >
    <div style="width: 100%; text-align: center">
<table class="table">
    <h1>Degree</h1>
    <tr>
        <td>
        <input type="text" id = "search" name="degreeName" required placeholder="Search Degree"
               autocomplete="off" data-toggle="popover" style="width:30%">
        <button onclick="showDegree()" class="btn btn-primary btn-lg">Show Degree</button>
        </td>
        </tr>
    <tr>
        <td>
        <label>Academic year: </label>
              <select id="year" class="btn-group">
    <option value="2014" selected="selected">2014</option>
    <option value="2015">2015</option>
    <option value="2016">2016</option>
    <option value="2017">2017</option>
    <option value="2018">2018</option>
    <option value="2019">2019</option>
    <option value="2020">2020</option>
</select>
        </td>
    </tr>
    </table>
        <div>&nbsp</div>
        <div class="table-responsive">
            <table class="table" style="width: 50%; margin: auto">
                    <tbody id="Table">
                    </tbody>
                </table>
        </div>
    </div>
</div>
    <script>
        let level="undergraduate";
        let description="";
        function showDegree() {
            let year=document.getElementById("year").value;
            let degree = document.getElementById("search").value;
            let tableData = "<thead class = \"thead-light\">\n" +
                "                    <tr>\n" +
                "                      <th scope=\"col\" width=\"30%\">Degree Code</th>\n" +
                "                      <th scope=\"col\" width=\"70%\">Degree Title</th>\n" +
                "                    </tr>\n" +
                "                  </thead>";
            tableData += "<tbody>\n" +
                "    <tr>";
            const degreeCodes = [];
            const degreeDicts = [];
            $.ajax({
                url: '../degree/all',
                success: function (data) {
                    for (i in data.response) {
                        if (data.response[i].title.toString().toLowerCase().indexOf(degree.toLowerCase()) != -1) {
                            degreeDicts.push(data.response[i].title);
                            degreeCodes.push(data.response[i].code);
                        }
                    }
                    if (degreeDicts.length == 0) {
                        tableData += "<th>" + "No such degree" + "</th>" + "</tr>";
                    } else {
                        for (var i = 0; i < degreeDicts.length; i++) {
                            for (var j = 0; j < 2; j++) {

                                    if (j == 0) {
                                        tableData += "<td style=\"text-align:left\">" + "<a href=\"degree_detail?code="
                                            + degreeCodes[i] + "&title=" + degreeDicts[i] + "&year=" + year + "\">" +
                                            degreeCodes[i] + "</a>" + "</td>";
                                    } else if (j==1){
                                        tableData += "<td style=\"text-align:left\">" + "<a href=\"degree_detail?code="
                                            + degreeCodes[i] + "&title=" + degreeDicts[i] + "&year=" + year + "\">" +
                                            degreeDicts[i] + "</a>" + "</td>";
                                    }


                            }
                            tableData += "</tr>" + "<tr>";
                        }
                    }
                    $("#Table").html(tableData);
                }
            });
        }
    </script>
{#<h1>Degree</h1>#}

{% endblock %}
